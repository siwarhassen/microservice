class VariantSelects extends HTMLElement{constructor(){super(),this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updatePickupAvailability(),this.currentVariant?(this.updateMedia(),this.updateURL(),this.updateVariantInput(),this.renderProductInfo(),this.doIshiTasks()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),(t=>t.value))}updateMasterId(){this.currentVariant=this.getVariantData().find((t=>!t.options.map(((t,e)=>this.options[e]===t)).includes(!1)))}updateMedia(){if(!this.currentVariant||!this.currentVariant?.featured_media)return;const t=document.querySelector(`[data-media-id="${this.dataset.section}-${this.currentVariant.featured_media.id}"]`);t&&(document.getElementById("main-media-container").innerHTML="",document.getElementById("main-media-container").prepend(t.cloneNode(!0)))}updateURL(){this.currentVariant&&window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){const t=undefined;document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach((t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))}))}updatePickupAvailability(){const t=document.querySelector("pickup-availability");t&&(this.currentVariant?.available?t.fetchAvailability(this.currentVariant.id):(t.removeAttribute("available"),t.innerHTML=""))}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then((t=>t.text())).then((t=>{const e=`price-${this.dataset.section}`;const a=(new DOMParser).parseFromString(t,"text/html");const i=document.getElementById(e);const n=a.getElementById(e);n&&i&&(i.innerHTML=n.innerHTML),document.getElementById(`price-${this.dataset.section}`)?.classList.remove("visibility-hidden"),this.toggleAddButton(!this.currentVariant.available,window.variantStrings.soldOut)}))}toggleAddButton(t=!0,e,a=!0){const i=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]');i&&(t?(i.setAttribute("disabled",!0),e&&(i.textContent=e)):(i.removeAttribute("disabled"),i.textContent=window.variantStrings.addToCart))}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]');t&&(t.textContent=window.variantStrings.unavailable,document.getElementById(`price-${this.dataset.section}`)?.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}doIshiTasks(){var t=this.currentVariant;var e=document.querySelector(".variant-sku");if("undefined"!=typeof e&&null!=e&&(document.querySelector(".variant-sku").innerHTML=t.sku),document.getElementsByClassName("ishi-progress-content").length){var a=0;var i=document.getElementById("variant-"+t.id);"undefined"!=typeof i&&null!=i&&(a=parseInt(i.getAttribute("data-stock")));var n=parseInt(document.getElementsByClassName("ishi-progress-content")[0].getAttribute("data-quantity"));if(document.getElementById("variant-stock").innerHTML=a,a>0&&a<=n){document.getElementsByClassName("ishi-progress-content")[0].classList.remove("hidden");var s=document.getElementById("ishi-progress-bar").getElementsByTagName("span")[0];switch(a){case 9:s.style.width="65%";break;case 8:s.style.width="60%";break;case 7:s.style.width="55%";break;case 6:s.style.width="50%";break;case 5:s.style.width="45%";break;case 4:s.style.width="30%";break;case 3:s.style.width="20%";break;case 2:s.style.width="10%";break;case 1:s.style.width="5%";break;default:s.style.width="90%"}}else document.getElementsByClassName("ishi-progress-content")[0].classList.add("hidden")}}}customElements.define("variant-selects",VariantSelects);class VariantRadios extends VariantSelects{constructor(){super()}updateOptions(){const t=Array.from(this.querySelectorAll("fieldset"));this.options=t.map((t=>Array.from(t.querySelectorAll("input")).find((t=>t.checked)).value))}}customElements.define("variant-radios",VariantRadios);
//# sourceMappingURL=/s/files/1/0285/6022/8445/t/5/assets/variants.js.map?v=2132837054811032715
